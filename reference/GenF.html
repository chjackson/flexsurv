<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generalized F distribution — GenF • flexsurv</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized F distribution — GenF"><meta name="description" content="Density, distribution function, hazards, quantile function and
random generation for the generalized F distribution, using the
reparameterisation by Prentice (1975)."><meta property="og:description" content="Density, distribution function, hazards, quantile function and
random generation for the generalized F distribution, using the
reparameterisation by Prentice (1975)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">flexsurv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pdf.html">flexsurv PDF vignettes</a></li>
    <li><a class="dropdown-item" href="../articles/standsurv.html">Calculating standardized survival measures in flexsurv</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/chjackson/flexsurv/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generalized F distribution</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/flexsurv/blob/master/R/GenF.R" class="external-link"><code>R/GenF.R</code></a></small>
      <div class="d-none name"><code>GenF.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Density, distribution function, hazards, quantile function and
random generation for the generalized F distribution, using the
reparameterisation by Prentice (1975).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dgenf</span><span class="op">(</span><span class="va">x</span>, mu <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="fl">1</span>, <span class="va">Q</span>, <span class="va">P</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pgenf</span><span class="op">(</span><span class="va">q</span>, mu <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="fl">1</span>, <span class="va">Q</span>, <span class="va">P</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span>, log.p <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Hgenf</span><span class="op">(</span><span class="va">x</span>, mu <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="fl">1</span>, <span class="va">Q</span>, <span class="va">P</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hgenf</span><span class="op">(</span><span class="va">x</span>, mu <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="fl">1</span>, <span class="va">Q</span>, <span class="va">P</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">qgenf</span><span class="op">(</span><span class="va">p</span>, mu <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="fl">1</span>, <span class="va">Q</span>, <span class="va">P</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span>, log.p <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rgenf</span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="fl">1</span>, <span class="va">Q</span>, <span class="va">P</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x-q">x, q<a class="anchor" aria-label="anchor" href="#arg-x-q"></a></dt>
<dd><p>Vector of quantiles.</p></dd>


<dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>Vector of location parameters.</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>Vector of scale parameters.</p></dd>


<dt id="arg-q">Q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>Vector of first shape parameters.</p></dd>


<dt id="arg-p">P<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Vector of second shape parameters.</p></dd>


<dt id="arg-log-log-p">log, log.p<a class="anchor" aria-label="anchor" href="#arg-log-log-p"></a></dt>
<dd><p>logical; if TRUE, probabilities p are given as log(p).</p></dd>


<dt id="arg-lower-tail">lower.tail<a class="anchor" aria-label="anchor" href="#arg-lower-tail"></a></dt>
<dd><p>logical; if TRUE (default), probabilities are \(P(X
\le x)\), otherwise, \(P(X &gt; x)\).</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Vector of probabilities.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>number of observations. If <code>length(n) &gt; 1</code>, the length is
taken to be the number required.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>dgenf</code> gives the density, <code>pgenf</code> gives the distribution
function, <code>qgenf</code> gives the quantile function, <code>rgenf</code> generates
random deviates, <code>Hgenf</code> retuns the cumulative hazard and <code>hgenf</code>
the hazard.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If \(y \sim F(2s_1, 2s_2)\), and \(w = \)\( \log(y)\) then \(x = \exp(w\sigma + \mu)\) has the original generalized F distribution with
location parameter \(\mu\), scale parameter \(\sigma&gt;0\)
and shape parameters \(s_1,s_2\).</p>
<p>In this more stable version described by Prentice (1975),
\(s_1,s_2\) are replaced by shape parameters \(Q,P\), with
\(P&gt;0\), and</p>
<p>$$s_1 = 2(Q^2 + 2P + Q\delta)^{-1}, \quad s_2 = 2(Q^2 + 2P -
Q\delta)^{-1}$$ equivalently $$Q = \left(\frac{1}{s_1} -
\frac{1}{s_2}\right)\left(\frac{1}{s_1} + \frac{1}{s_2}\right)^{-1/2},
\quad P = \frac{2}{s_1 + s_2} $$</p>
<p>Define \(\delta = (Q^2 + 2P)^{1/2}\), and
\(w = (\log(x) - \mu)\delta /\sigma\),
then the probability density function of \(x\) is $$ f(x) =
\frac{\delta (s_1/s_2)^{s_1} e^{s_1 w}}{\sigma x (1 + s_1 e^w/s_2) ^ {(s_1
+ s_2)} B(s_1, s_2)} $$ The
original parameterisation is available in this package as
<code><a href="GenF.orig.html">dgenf.orig</a></code>, for the sake of completion / compatibility.  With
the above definitions,</p>
<p><code>dgenf(x, mu=mu, sigma=sigma, Q=Q, P=P) = dgenf.orig(x, mu=mu,
sigma=sigma/delta, s1=s1, s2=s2)</code></p>
<p>The generalized F distribution with <code>P=0</code> is equivalent to the
generalized gamma distribution <code><a href="GenGamma.html">dgengamma</a></code>, so that
<code>dgenf(x, mu, sigma, Q, P=0)</code> equals <code>dgengamma(x, mu, sigma,
Q)</code>.  The generalized gamma reduces further to several common
distributions, as described in the <code><a href="GenGamma.html">GenGamma</a></code> help page.</p>
<p>The generalized F distribution includes the log-logistic distribution (see
<code><a href="https://ehar.se/r/eha/reference/Loglogistic.html" class="external-link">eha::dllogis</a></code>) as a further special case:</p>
<p><code>dgenf(x, mu=mu, sigma=sigma, Q=0, P=1) = <a href="https://ehar.se/r/eha/reference/Loglogistic.html" class="external-link">eha::dllogis</a>(x,
shape=sqrt(2)/sigma, scale=exp(mu))</code></p>
<p>The range of hazard trajectories available under this distribution are
discussed in detail by Cox (2008).  Jackson et al. (2010) give an
application to modelling oral cancer survival for use in a health economic
evaluation of screening.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The parameters <code>Q</code> and <code>P</code> are usually called \(q\) and
\(p\) in the literature - they were made upper-case in these R functions
to avoid clashing with the conventional arguments <code>q</code> in the
probability function and <code>p</code> in the quantile function.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>R. L. Prentice (1975). Discrimination among some parametric
models. Biometrika 62(3):607-614.</p>
<p>Cox, C. (2008). The generalized \(F\) distribution: An umbrella for
parametric survival analysis.  Statistics in Medicine 27:4301-4312.</p>
<p>Jackson, C. H. and Sharples, L. D. and Thompson, S. G. (2010).  Survival
models in health economic evaluations: balancing fit and parsimony to
improve prediction.  International Journal of Biostatistics 6(1):Article
34.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="GenF.orig.html">GenF.orig</a></code>, <code><a href="GenGamma.html">GenGamma</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Christopher Jackson &lt;chris.jackson@mrc-bsu.cam.ac.uk&gt;</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

