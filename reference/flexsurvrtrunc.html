<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function estimates the distribution of the time between an initial and final event, in situations where individuals are only observed if they have experienced both events before a certain time, thus they are right-truncated at this time.   The time of the initial event provides information about the time from initial to final event, given the truncated observation scheme, and initial events are assumed to occur with an exponential growth rate."><title>Flexible parametric models for right-truncated, uncensored data defined by times of initial and final events. — flexsurvrtrunc • flexsurv</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Flexible parametric models for right-truncated, uncensored data defined by times of initial and final events. — flexsurvrtrunc"><meta property="og:description" content="This function estimates the distribution of the time between an initial and final event, in situations where individuals are only observed if they have experienced both events before a certain time, thus they are right-truncated at this time.   The time of the initial event provides information about the time from initial to final event, given the truncated observation scheme, and initial events are assumed to occur with an exponential growth rate."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">flexsurv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/pdf.html">flexsurv PDF vignettes</a>
    <a class="dropdown-item" href="../articles/standsurv.html">Calculating standardized survival measures in flexsurv</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/chjackson/flexsurv/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Flexible parametric models for right-truncated, uncensored data defined by times of initial and final events.</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/flexsurv/blob/HEAD/R/flexsurvrtrunc.R" class="external-link"><code>R/flexsurvrtrunc.R</code></a></small>
      <div class="d-none name"><code>flexsurvrtrunc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function estimates the distribution of the time between an initial and final event, in situations where individuals are only observed if they have experienced both events before a certain time, thus they are right-truncated at this time.   The time of the initial event provides information about the time from initial to final event, given the truncated observation scheme, and initial events are assumed to occur with an exponential growth rate.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">flexsurvrtrunc</span><span class="op">(</span></span>
<span>  <span class="va">t</span>,</span>
<span>  <span class="va">tinit</span>,</span>
<span>  <span class="va">rtrunc</span>,</span>
<span>  <span class="va">tmax</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"joint"</span>,</span>
<span>  <span class="va">dist</span>,</span>
<span>  theta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fixed.theta <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  inits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fixedpars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dfns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  integ.opts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cl <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  optim_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>t</dt>
<dd><p>Vector of time differences between an initial and final event for a set of individuals.</p></dd>


<dt>tinit</dt>
<dd><p>Absolute time of the initial event for each individual.</p></dd>


<dt>rtrunc</dt>
<dd><p>Individual-specific right truncation points on the same scale as <code>t</code>, so that each individual's survival time <code>t</code> would not have been observed if it was greater than the corresponding element of <code>rtrunc</code>.  Only used in <code>method="joint"</code>.  In <code>method="final"</code>, the right-truncation is implicit.</p></dd>


<dt>tmax</dt>
<dd><p>Maximum possible time between initial and final events that could have been observed.  This is only used in <code>method="joint"</code>, and is ignored in <code>method="final"</code>.</p></dd>


<dt>data</dt>
<dd><p>Data frame containing <code>t</code>, <code>rtrunc</code> and <code>tinit</code>.</p></dd>


<dt>method</dt>
<dd><p>If <code>"joint"</code> then the "joint-conditional" method is used.  If <code>"final"</code> then the "conditional-on-final" method is used.   The "conditional-on-initial" method can be implemented by using <code><a href="flexsurvreg.html">flexsurvreg</a></code> with a <code>rtrunc</code> argument.  These methods are all described in Seaman et al. (2020).</p></dd>


<dt>dist</dt>
<dd><p>Typically, one of the strings in the first column of the
  following table, identifying a built-in distribution.  This table also
  identifies the location parameters, and whether covariates on these
  parameters represent a proportional hazards (PH) or accelerated failure
  time (AFT) model.  In an accelerated failure time model, the covariate
  speeds up or slows down the passage of time.  So if the coefficient
  (presented on the log scale) is log(2), then doubling the covariate value
  would give half the expected survival time.</p>
<p></p><table class="table table"><tr><td><code>"gengamma"</code></td><td>Generalized gamma (stable)</td><td>mu</td><td>AFT</td></tr><tr><td><code>"gengamma.orig"</code></td><td>Generalized gamma (original)</td><td>scale</td><td>AFT</td></tr><tr><td><code>"genf"</code></td><td>Generalized F (stable)</td><td>mu</td><td>AFT</td></tr><tr><td><code>"genf.orig"</code></td><td>Generalized F (original)</td><td>mu</td><td>AFT</td></tr><tr><td><code>"weibull"</code></td><td>Weibull</td><td>scale</td><td>AFT</td></tr><tr><td><code>"gamma"</code></td><td>Gamma</td><td>rate</td><td>AFT</td></tr><tr><td><code>"exp"</code></td><td>Exponential</td><td>rate</td><td>PH</td></tr><tr><td><code>"llogis"</code></td><td>Log-logistic</td><td>scale</td><td>AFT</td></tr><tr><td><code>"lnorm"</code></td><td>Log-normal</td><td>meanlog</td><td>AFT</td></tr><tr><td><code>"gompertz"</code></td><td>Gompertz</td><td>rate</td><td>PH</td></tr></table><p><code>"exponential"</code> and <code>"lognormal"</code> can be used as aliases for
  <code>"exp"</code> and <code>"lnorm"</code>, for compatibility with
  <code>survreg</code>.</p>
<p>Alternatively, <code>dist</code> can be a list specifying a custom distribution.
  See section ``Custom distributions'' below for how to construct this list.</p>
<p>Very flexible spline-based distributions can also be fitted with
  <code><a href="flexsurvspline.html">flexsurvspline</a></code>.</p>
<p>The parameterisations of the built-in distributions used here are the same
  as in their built-in distribution functions: <code><a href="GenGamma.html">dgengamma</a></code>,
  <code><a href="GenGamma.orig.html">dgengamma.orig</a></code>, <code><a href="GenF.html">dgenf</a></code>,
  <code><a href="GenF.orig.html">dgenf.orig</a></code>, <code><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">dweibull</a></code>, <code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></code>,
  <code><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></code>, <code><a href="https://ehar.se/r/eha/reference/Lognormal.html" class="external-link">dlnorm</a></code>, <code><a href="Gompertz.html">dgompertz</a></code>,
  respectively.  The functions in base R are used where available,
  otherwise, they are provided in this package.</p>
<p>A package vignette "Distributions reference" lists the survivor functions
  and covariate effect parameterisations used by each built-in distribution.</p>
<p>For the Weibull, exponential and log-normal distributions,
  <code><a href="flexsurvreg.html">flexsurvreg</a></code> simply works by calling <code>survreg</code> to
  obtain the maximum likelihood estimates, then calling <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>
  to double-check convergence and obtain the covariance matrix for
  <code><a href="flexsurvreg.html">flexsurvreg</a></code>'s preferred parameterisation.</p>
<p>The Weibull parameterisation is different from that in
  <code><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survreg</a></code>, instead it is consistent with
  <code><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">dweibull</a></code>.  The <code>"scale"</code> reported by
  <code><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survreg</a></code> is equivalent to <code>1/shape</code> as defined
  by <code><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">dweibull</a></code> and hence <code><a href="flexsurvreg.html">flexsurvreg</a></code>.  The first
  coefficient <code>(Intercept)</code> reported by <code><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survreg</a></code>
  is equivalent to <code>log(scale)</code> in <code><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">dweibull</a></code> and
  <code><a href="flexsurvreg.html">flexsurvreg</a></code>.</p>
<p>Similarly in the exponential distribution, the rate, rather than the mean,
  is modelled on covariates.</p>
<p>The object <code>flexsurv.dists</code> lists the names of the built-in
  distributions, their parameters, location parameter, functions used to
  transform the parameter ranges to and from the real line, and the
  functions used to generate initial values of each parameter for
  estimation.</p></dd>


<dt>theta</dt>
<dd><p>Initial value (or fixed value) for the exponential growth rate <code>theta</code>. Defaults to 1.</p></dd>


<dt>fixed.theta</dt>
<dd><p>Should <code>theta</code> be fixed at its initial value or estimated.  This only applies to <code>method="joint"</code>.  For <code>method="final"</code>, <code>theta</code> must be fixed.</p></dd>


<dt>inits</dt>
<dd><p>Initial values for the parameters of the parametric survival distributon. If not supplied, a heuristic is used. as is done in <code><a href="flexsurvreg.html">flexsurvreg</a></code>.</p></dd>


<dt>fixedpars</dt>
<dd><p>Integer indices of the parameters of the survival distribution that should be fixed to their values supplied in <code>inits</code>.   Same length as <code>inits</code>.</p></dd>


<dt>dfns</dt>
<dd><p>An alternative way to define a custom survival distribution (see
  section ``Custom distributions'' below).  A list whose components may
  include <code>"d"</code>, <code>"p"</code>, <code>"h"</code>, or <code>"H"</code> containing the
  probability density, cumulative distribution, hazard, or cumulative hazard
  functions of the distribution.  For example,</p>
<p><code>list(d=dllogis, p=pllogis)</code>.</p>
<p>If <code>dfns</code> is used, a custom <code>dlist</code> must still be provided, but
  <code>dllogis</code> and <code>pllogis</code> need not be visible from the global
  environment.  This is useful if <code>flexsurvreg</code> is called within other
  functions or environments where the distribution functions are also
  defined dynamically.</p></dd>


<dt>integ.opts</dt>
<dd><p>List of named arguments to pass to
  <code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></code>, if a custom density or hazard is provided without
  its cumulative version.  For example,</p>
<p><code>integ.opts = list(rel.tol=1e-12)</code></p></dd>


<dt>cl</dt>
<dd><p>Width of symmetric confidence intervals for maximum likelihood
estimates, by default 0.95.</p></dd>


<dt>optim_control</dt>
<dd><p>List to supply as the <code>control</code> argument to <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> to control the likelihood maximisation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Covariates are not currently supported.</p>
<p>Note that <code><a href="flexsurvreg.html">flexsurvreg</a></code>, with an <code>rtrunc</code> argument, can fit models for a similar kind of data, but those models ignore the information provided by the time of the initial event.</p>
<p>A nonparametric estimator of survival under right-truncation is also provided in <code><a href="survrtrunc.html">survrtrunc</a></code>.  See Seaman et al. (2020) for a full comparison of the alternative models.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Seaman, S., Presanis, A. and Jackson, C. (2020) Estimating a Time-to-Event
Distribution from Right-Truncated Data in an Epidemic: a Review of Methods</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="flexsurvreg.html">flexsurvreg</a></code>, <code><a href="survrtrunc.html">survrtrunc</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="co">## simulate time to initial event</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## simulate time between initial and final event</span></span></span>
<span class="r-in"><span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## right-truncate to keep only those with final event time</span></span></span>
<span class="r-in"><span><span class="co">## before tmax</span></span></span>
<span class="r-in"><span><span class="va">tmax</span> <span class="op">&lt;-</span> <span class="fl">40</span></span></span>
<span class="r-in"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op">+</span> <span class="cn">T</span> <span class="op">&lt;</span> <span class="va">tmax</span> </span></span>
<span class="r-in"><span><span class="va">rtrunc</span> <span class="op">&lt;-</span> <span class="va">tmax</span> <span class="op">-</span> <span class="va">X</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">X</span>, <span class="cn">T</span>, <span class="va">rtrunc</span><span class="op">)</span><span class="op">[</span><span class="va">obs</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">flexsurvrtrunc</span><span class="op">(</span>t<span class="op">=</span><span class="cn">T</span>, rtrunc<span class="op">=</span><span class="va">rtrunc</span>, tinit<span class="op">=</span><span class="va">X</span>, tmax<span class="op">=</span><span class="fl">40</span>, data<span class="op">=</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>                dist<span class="op">=</span><span class="st">"gamma"</span>, theta<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flexsurvrtrunc(t = T, tinit = X, rtrunc = rtrunc, tmax = 40, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = dat, dist = "gamma", theta = 0.2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         pars   est   lcl   ucl  estlog   selog</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  shape  1.93  1.78   2.1   0.659  0.0414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate    rate  9.22  8.39  10.1   2.222  0.0483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta  theta  1.22    NA    NA   0.200      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood = -7846.25, df = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC = 15696.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">flexsurvrtrunc</span><span class="op">(</span>t<span class="op">=</span><span class="cn">T</span>, rtrunc<span class="op">=</span><span class="va">rtrunc</span>, tinit<span class="op">=</span><span class="va">X</span>, tmax<span class="op">=</span><span class="fl">40</span>, data<span class="op">=</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>                dist<span class="op">=</span><span class="st">"gamma"</span>, theta<span class="op">=</span><span class="fl">0.2</span>, fixed.theta<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flexsurvrtrunc(t = T, tinit = X, rtrunc = rtrunc, tmax = 40, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = dat, dist = "gamma", theta = 0.2, fixed.theta = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         pars    est    lcl     ucl  estlog    selog</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  shape  1.932  1.781   2.095   0.658  0.04144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate    rate  9.419  8.586  10.334   2.243  0.04728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta  theta  0.824  0.814   0.834  -0.193  0.00621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood = -1949.284, df = 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC = 3904.568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">flexsurvrtrunc</span><span class="op">(</span>t<span class="op">=</span><span class="cn">T</span>, rtrunc<span class="op">=</span><span class="va">rtrunc</span>, tinit<span class="op">=</span><span class="va">X</span>, tmax<span class="op">=</span><span class="fl">40</span>, data<span class="op">=</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>                dist<span class="op">=</span><span class="st">"gamma"</span>, theta<span class="op">=</span><span class="fl">0.2</span>, inits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flexsurvrtrunc(t = T, tinit = X, rtrunc = rtrunc, tmax = 40, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = dat, dist = "gamma", theta = 0.2, inits = c(1, 8))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         pars   est   lcl   ucl  estlog   selog</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  shape  1.93  1.78   2.1   0.659  0.0414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate    rate  9.22  8.39  10.1   2.222  0.0483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta  theta  1.22    NA    NA   0.200      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood = -7846.25, df = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC = 15696.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">flexsurvrtrunc</span><span class="op">(</span>t<span class="op">=</span><span class="cn">T</span>, rtrunc<span class="op">=</span><span class="va">rtrunc</span>, tinit<span class="op">=</span><span class="va">X</span>, tmax<span class="op">=</span><span class="fl">40</span>, data<span class="op">=</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>                dist<span class="op">=</span><span class="st">"gamma"</span>, theta<span class="op">=</span><span class="fl">0.2</span>, method<span class="op">=</span><span class="st">"final"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flexsurvrtrunc(t = T, tinit = X, rtrunc = rtrunc, tmax = 40, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = dat, method = "final", dist = "gamma", theta = 0.2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         pars   est   lcl   ucl  estlog   selog</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  shape  1.94  1.79  2.11   0.663  0.0415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate    rate  9.05  8.22  9.97   2.203  0.0493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta  theta  1.22    NA    NA   0.200      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood = 715.5208, df = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC = -1427.042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">flexsurvrtrunc</span><span class="op">(</span>t<span class="op">=</span><span class="cn">T</span>, rtrunc<span class="op">=</span><span class="va">rtrunc</span>, tinit<span class="op">=</span><span class="va">X</span>, tmax<span class="op">=</span><span class="fl">40</span>, data<span class="op">=</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>                dist<span class="op">=</span><span class="st">"gamma"</span>, fixed.theta<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flexsurvrtrunc(t = T, tinit = X, rtrunc = rtrunc, tmax = 40, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = dat, dist = "gamma", fixed.theta = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         pars   est   lcl   ucl  estlog   selog</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  shape  1.93  1.78  2.09   0.658  0.0415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate    rate  8.41  7.58  9.33   2.130  0.0529</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta  theta  2.72    NA    NA   1.000      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood = -33947.91, df = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC = 67899.82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">flexsurvrtrunc</span><span class="op">(</span>t<span class="op">=</span><span class="cn">T</span>, rtrunc<span class="op">=</span><span class="va">rtrunc</span>, tinit<span class="op">=</span><span class="va">X</span>, tmax<span class="op">=</span><span class="fl">40</span>, data<span class="op">=</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>                dist<span class="op">=</span><span class="st">"weibull"</span>, fixed.theta<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flexsurvrtrunc(t = T, tinit = X, rtrunc = rtrunc, tmax = 40, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = dat, dist = "weibull", fixed.theta = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         pars    est    lcl    ucl  estlog   selog</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  shape  1.501  1.430  1.577   0.406  0.0249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale  scale  0.252  0.241  0.264  -1.378  0.0240</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta  theta  2.718     NA     NA   1.000      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood = -33950.21, df = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC = 67904.42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">flexsurvrtrunc</span><span class="op">(</span>t<span class="op">=</span><span class="cn">T</span>, rtrunc<span class="op">=</span><span class="va">rtrunc</span>, tinit<span class="op">=</span><span class="va">X</span>, tmax<span class="op">=</span><span class="fl">40</span>, data<span class="op">=</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>                dist<span class="op">=</span><span class="st">"lnorm"</span>, fixed.theta<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flexsurvrtrunc(t = T, tinit = X, rtrunc = rtrunc, tmax = 40, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = dat, dist = "lnorm", fixed.theta = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             pars     est     lcl    ucl  estlog   selog</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> meanlog  meanlog  -1.694  -1.758  -1.63  -1.694  0.0325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sdlog      sdlog   0.893   0.848   0.94  -0.113  0.0264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta      theta   2.718      NA     NA   1.000      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood = -33991.77, df = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC = 67987.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">flexsurvrtrunc</span><span class="op">(</span>t<span class="op">=</span><span class="cn">T</span>, rtrunc<span class="op">=</span><span class="va">rtrunc</span>, tinit<span class="op">=</span><span class="va">X</span>, tmax<span class="op">=</span><span class="fl">40</span>, data<span class="op">=</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>                dist<span class="op">=</span><span class="st">"gengamma"</span>, fixed.theta<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flexsurvrtrunc(t = T, tinit = X, rtrunc = rtrunc, tmax = 40, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = dat, dist = "gengamma", fixed.theta = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         pars     est     lcl     ucl  estlog   selog</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu        mu  -1.446  -1.520  -1.371  -1.446  0.0379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma  sigma   0.702   0.657   0.750  -0.354  0.0335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q          Q   0.798   0.631   0.964   0.798  0.0851</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta  theta   2.718      NA      NA   1.000      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood = -33947.48, df = 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC = 67900.97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">flexsurvrtrunc</span><span class="op">(</span>t<span class="op">=</span><span class="cn">T</span>, rtrunc<span class="op">=</span><span class="va">rtrunc</span>, tinit<span class="op">=</span><span class="va">X</span>, tmax<span class="op">=</span><span class="fl">40</span>, data<span class="op">=</span><span class="va">dat</span>,</span></span>
<span class="r-in"><span>                dist<span class="op">=</span><span class="st">"gompertz"</span>, fixed.theta<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flexsurvrtrunc(t = T, tinit = X, rtrunc = rtrunc, tmax = 40, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = dat, dist = "gompertz", fixed.theta = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         pars   est   lcl   ucl  estlog   selog</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape  shape  2.58  2.18  2.97   2.576  0.2009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rate    rate  2.63  2.37  2.92   0.968  0.0532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theta  theta  2.72    NA    NA   1.000      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood = -33990.12, df = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC = 67984.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

